#!/opt/local/bin/python
######################################################################################
# This script computes the rank of radar unit vector matrix as well as its SVD. 
# 	Unit vectors must be computed beforehand e.g. with Earth2Sat_UnitVectors.py
# 	and hard coded manually here below as a matrix. 
#
# Parameters:	- none
# 
# Dependencies:	- python 3.10
#
# New in V1.0 : - 
#
# AMSTer: SAR & InSAR Automated Mass processing Software for Multidimensional Time series
# Nicolas d'Oreye, (c)2024
######################################################################################

import numpy as np
import sys

# Matrix of Earth-Sat unit vectors - to hard code manually
	
matrixA = np.array([
	[ 0.1293542220414924 , 0.9204031149765991 , 0.3689520174513399 ],
	[ 0.1246479649405262 , 0.8869163556946283 , 0.44479462995583124 ],
	[ 0.1321880926153305 , 0.8346027699720475 , 0.5347565095683328 ],
	[ 0.12006429419593928 , 0.7580561193380013 , 0.6410424987420419 ],
	[ 0.1124220046292113 , 0.6375768709786237 , 0.7621397683287869 ],
	[ 0.08872287469341698 , 0.4564396213124487 , 0.8853197860673196 ],
	[ 0.07657316042678029 , 0.3602483961217544 , 0.929708365130678 ],
	[ 0.13030895038733895 , 0.5644300748060498 , 0.8151308288265062 ],
	[ 0.1740548424893721 , 0.6980958436459583 , 0.6945265328914636 ],
	[ 0.19694427776989196 , 0.7899003542484702 , 0.5807498444354825 ],
	[ 0.22626062514688355 , 0.8444161488004659 , 0.4855589533240334 ],
	[ 0.2517302960279394 , 0.8778878703201837 , 0.40736316132706274 ],
	[ 0.10000902015051828 , -0.5145018062486048 , 0.8516372979475808 ],
	[ 0.13060366456412703 , -0.6718976070338193 , 0.7290379197714262 ],
	[ 0.13772099286529144 , -0.7810545630166272 , 0.6090867735512763 ],
	[ 0.14183426175725386 , -0.8955062850026763 , 0.42184302259546774 ],
	[ 0.27325891111510886 , -0.8937896249449772 , 0.35562574968202465 ],
	[ 0.2492903368949341 , -0.86937872159736 , 0.4266555593972148 ],
	[ 0.2369607274278755 , -0.8263802634550221 , 0.5108280276461543 ],
	[ 0.20495845525976028 , -0.7649153684702579 , 0.6106525286081623 ],
	[ 0.1662871532509677 , -0.6669413437509337 , 0.7263179927961223 ],
	[ 0.12748501575574703 , -0.5113144705046666 , 0.8498853352131036 ]
	])
	
print("Rank of the Matrix: ", np.linalg.matrix_rank(matrixA))	


# Singular-value decomposition
from numpy import array
from scipy.linalg import svd

# SVD
U, s, VT = svd(matrixA)
print(U)
print(s)
print(VT)